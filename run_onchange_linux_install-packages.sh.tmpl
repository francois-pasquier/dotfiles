#!/bin/bash

{{ if eq .chezmoi.os "linux" -}}
{{   if eq .chezmoi.osRelease.id "debian" "ubuntu" -}}
# Only run if we have apt-get
if command -v apt-get &>/dev/null; then
  echo "Detected Debian/Ubuntu system. Installing packages via apt..."

  # Update apt cache
  sudo apt-get update

printf "\nStarting apt packages installation...\n"
  {{ range .packages.linux.apt -}}
  sudo apt-get install -y {{ . | quote }}
  {{ end -}}

  echo "Apt packages installation complete."

  printf "\nRemoving unused packages...\n"
  sudo apt-get autoremove -y
else
  echo "apt-get not found, skipping apt package installation."
fi
{{   end -}}

printf "\nStarting snaps installation...\n"
if command -v snap &>/dev/null; then
  {{ range .packages.linux.snaps -}}
  sudo snap install {{ . | quote }}
  {{ end -}}
fi
printf "\Snaps installation complete\n"

printf "\nStarting homebrew installation...\n"
if command -v brew &>/dev/null; then
  echo "Installing Homebrew packages..."
  {{ range .packages.linux.brews -}}
  brew install {{ . | quote }}
  {{ end -}}
fi
printf "\Homebrew installation complete\n"




# Install Zed
curl -f https://zed.dev/install.sh | sh

{{ end -}}
